
# Notes:
# check function checks if the file is within the types listed by the program and then continues
# sx.q = sign extend I think

# ENC IS: 
'''
.â•¡â– 4hÃ¦Îµ4)R9Ã·â–’Ã­ERSECURESUPE]SECâ”¤â”€Â¬â”â•šâŒ‚sâ”€â••â–’â•¢â˜»Î£Â¶â•œâ†‘Ã‡Qâ”˜Bâ”¬MÂ°â•(â”ŒÃ¼Ã¯Îµâ–’â˜¼Ï€â™€Ã¤Â Z%â•jÃ¢â–„DÃºâ””Â¡;IÃªâ”‚âŒ¡â•ŸÏ„âŒ¡â™¦Ï€Î¦â”€MIqâ†“>â•‘|â• lÂ£â–²Yâ™¦â–‘Ã¿'s                â™¥â•˜>Ã¬H-`Ã·}lX.Â½Ã¯râ€¼â”¬Âµ`â–‘Â¼xrâ•˜â”œâ•”9Iâ˜¼â”Œrâ•¬Ã ~Ï†w>l%=Wâ†¨Â¬Z{â†”;s-â†•Â â–ˆZiÃ®â–€[iÎ©`â–„jÃœÂºâ‚§Nâ•â‰¥Ã…|â•˜vâ–ˆâ˜¼â•¦Oâ– uÏ†â–Â vâ™£Â±â•«Ã¥â•¬_Â mâ•›â”¤`?Ã‡ÃºÃ¡WMâ•œâ†•â•—G4RESÃ¹RERÃºÃ‰FYfE[]XEFÃ·Ã­Ã¶URESUPERSECUaESUâ•šâ–’Ã¼â•©â”¤â•¡â””â”¤â”¤â”¬â””~â•œâ”â”â•¥Ã»0â”” Ã¢aâ•$âŒkâ”â•‘â•¤Â¢â•ªÂ°Ã»âˆgâ”¼â•œâˆ™â™¥â”œâ•‘Â IÂ«â™ .Â¬â–q\gâ”¼0â™¥â•˜orâ†“â–‘â• 0â•¢aâ•¬Ã¹ÂºÃ®Ã¼vÎ“\zâ¿Ã¿â”ZÃ ÂªÂ¡Ï„â™¥Â¡WÃ§aÃ–âŒ Ã¡Â±âˆš[N;â–ˆNÃ +Â¼9Â·)Ã±~Ã¬~Â¼â€¼Â½a,*Â¥DÃ„â˜¼Â¬Ã¯â–’zâ”¤Ã„TEâ–‘&Â§â”œÃ‰"rzâ–ŒÃ–â†”Ã«nâ™«Ã§0â–ºâˆšXâ•¦Â«Â«Uâ•›âŒcâ–„1yâ•‘â™‚Ã²âˆ©Â£Î©Î±Râ–¬ Ãœw]Â¥.â•–1â”¼Â§sÂ¶â”¼6Â¢1â–‘Ã©Â¼â–ºÎ˜Î±ÃœÃ¬â•©=`5â•-â”œ9b!Ã´â™‚âŒ‚Â¥â‰¤â•¤â‰ˆB(â•Ã«tâ•šN{Âµ,[â‰¡â™‚   Ã‰â•¥(M=hT`JÃ‘Â£Â¼Ã…8Î¦ad*Æ’Ã‰hâ•ŸqJâ‰¡â”Œâ¿â”¬â•¡â•—Î˜gÂ Ã¹â€¼ Di#â•œâ•¤â™€Ã„(Ã¦$â•—vÃºâ‰ˆÃ¹Ã‡|â•ª&Ã³k^ CÃ²Î´jÎ¦{Seâ–²â•fâ””'â™«oÃŸÂ·â•Â±Ã…â•§Æ’]0?N+â•¤â•”'Â¼Ãºâ•¡Ã†â–Â±Î±Â¼Â¬â•ª?Sâ–¬   â™‚â•Ÿ"âŒ 0Î´â•¬â†‘8â”˜â”´ÂºLâ‰¡â•“â”˜âŒ^â”‚â–¬gâ”€mâ–€Ã…Ã¯E(@|Â»zâ•¦â†‘â•˜â–‘0â•¡â•â–¼Â¥Ã–bÃ¿Ã…AÃ‰Â²ATâ•šfÃ¬Mnâ•ŸÂ¢â•¤ â–’Ã¡â™£.Î©Ã·Ã¥qâ–“Ï†0â•«ffbâ–€`6â”‚câ•©âˆš8â”¤ÏƒLâ‰ˆÃ‰â”¼Â¡câ–¼xS                                           Î©â–Œâ–ºKâ• Â±Ãœâ•™Â§Ã :Ã‘3â•«dpâ˜¼Eg|â– 9CÎ˜Â Î˜â™‚bFÃ§â”¼âˆ©â–“#0â–ˆâ•”@â•Ã¦â•¥Â·>â•_MDo]PÃºâ•£Ã„FÃ…â•¤â˜ºyâ”œâ•£â‰¡â•–yâ™‚â•”Ï†Ãºâ•£Ã†Ã„Ã³câ•ŸÃ´â†•     â‰ˆâ”¤##â™€5U'+Æ’Ã¬:Â¼Â«~Ã¬Vâ˜¼/Rrâ™¥Ã‘Ã³â†¨7ZÃ‘Â¥L[â–²â–¼hâˆšOFCUâ•”HSUÃ¡Ã‰UWYC]ZMSIâ‰¤Ã­ÃºSECURESUPERSRCURâ•œâ”Ã¤â”œâ•£â•¦â”Â¬â•¢Ã¢â•©â–“â”BÂ¿Ã¶Ã­.u_â†•AÃ¿Â½â€¼â–€iwgâ–ŒÂ§uâ†‘â†“â•âˆYâ•¥ttÃ†~Ï†â–¬Ã„âŒ‚Qwâ‰ˆÂ»â•—=7PÃ¯Ã´&â”˜â†•kâ•Ÿâ”ŒZâˆ|-tâ†•LL7>âˆšâ•—â•“Î±Ï„%;ÂµÂµâˆ©&+}â–¬â†”Ã­5Ã¦Î¦Ã¥â”´â– Ï†â•¤Ã¼â–¬â†”Â¿gâ”¼Â§â”ŒÏ„Ãª.Ã²â•“Ã¤"Tâ–ˆâ™¦RÎ©Ã®gÎ©iâ•“â•¥yÃ Â»â‚§â‚§â•˜\GÂµÂ¬Ã±Uâ”¼â‰ˆÂ»m6Â¢Âµufâ•¦â™€_Ã¦â‰¡~v^nÃ¦Â¶â”œ_Kâ†¨vÃ´fâ™«dâ••â”‚`â˜¼â†¨ÂºÂ¼âŒ¡$Ã¿â†‘|1â”¼EÎ©Ã¥Ã¿ÃºAÆ’5Ã‘7~â”ŒÃ¹hÎ±â•šÃ§^Ã¨â•Ã¥|â”˜â–¼=â–¬â†”Vâ•›â–“)âŒ â•¬xzHÃ 0â†•â˜ºJÆ’7âŒ¡â”˜â–º-vÂµxÃ‘âŒ‚Ã–=â”H6â•ª'qOâ‰¥Ï€6mÃ¦VÃº]PÂ§âˆ©Ïƒâ”Œâ•œâˆ©F|â”¤â‰¥e%âŒâ••.'Ãºâ¿Dâ†•9l:Lâ™‚?&Ã‘HHfâ–ˆâ™¥â”Œ2â•§x Dâ”´â•¤,â–º@â•©Î©â””Ã´/â–ŒÃ®â”¼*Ã¹â˜ºÂ«â†¨`K!â”˜ÃŸâ‰¥Ã‰!Æ’y-â–ŒÂ§â–‘â‰¡Ã¼â–¼â–’NÎµâ™£â•¡âˆÏ€â•‘dÂ ÂµÂ½"u=[â˜»?âˆšÂ°P|râ–²q4$ivÃ‰ÃœKâ”˜â‰ˆâ†¨â•¨âˆyÃ¡/Hâ•’â•§â•Æ’;=       Bâ–¼Ã–â–Œâ–²â”˜â•©Nvâ–¬Âº<yeâŒâ–²V"'k}Î˜Hâ••Ã‘kÂ±â–ŒlÃ–â•©Ï†âˆ©Ï„Ã¡â•š<â”´â—„aâ•‘MaÂµÆ’â–“â•ªIÂ¿â•£â•ŸÃ‡8â•ªâˆÎ“â˜»â˜»â•’â–â•“Îµâ•™â–â•’âˆâ•šâ–„â–“â–²
'''

def change():
	# some of the translations
	
	a = 'hello world'
	b = 'â•—â•‘â•â–’â”´sâ•â–“â•Ÿâ•›âŒ'

	a = '     '
	b = 'super'

	# a = 'hhhhh'
	# a = 'hhhhhhhhhhhhhhhhhhhhhhhhh'
	# b = 'Â»Â½Â¸Â­ÂºÂ»Â­Â«Â½ÂºÂ­Â»Â½Â¸Â­ÂºÂ»Â­Â«Â½ÂºÂ­Â»Â½Â¸Â­ÂºÂ»Â­Â«'

	a = 'SUPERSECURESUPERSECURESUPERSECURESUPERSECURESUPERSECURESUPERSECURE'
	b = 'SUPERSECURESoPERÃ‹Â±rÂ´Ã„ÂªÂ¿ÃˆÂ¼ÃÃ…Â°Â¥Ã„ÃÂ°ÂÃÂ½Â±â‚¬Ã…ÂªÂ¯ÃˆÃ¿Ã–Â Ã€u^Ã™4@jËœ<Å¾WÂ¨Ãâ€¹Ãâ€“BKVâ€“4#	yÃ§(ÃºRÃ“~`Â­]Âª/%Ã¥*HÂG=yÃ?Ãš	â€“aVÃ¯Ã´WÃŠÃˆMÃ–M3?4^â„¢"Ã´#3Â½uÃ”rWÃ®eÃ“lâ„¢tÂ¬8{Â®â‚¬Â§Ã¥â€¹Â¢Ã¶Ââ€˜Ã¾)Ã˜=â€“Â7Å’(Ã®F jÂ£Ã²Â­VÃ¹Â±â‚¬Â¢ Ã†OÃµÂµ*RQÂ´ÃµÃ€Ã²â€¦R[ Â·aÃ¦â€¦Â¥Ã¤Â²%}â€šwJIÂ¿>8â€™5â€tpfÃˆÃ²Â§â€ Â¼[(Â¤Â©sAÂ¿^Ã„Y Ã¿Â£Ãƒ/Qv8EÃ©Å Ã¿# Ã‘Tâ€¢Å¾\\Xâ€BLÂ¿URExWPEÂ¢Å¾HGiRM[]P9ÃµÂ¯â€“CURESUPERSECiRE'
	b = 'SUPERSECUaESUÃˆÂ±ÂÃŠÂ´ÂµÃ€Â´Â´Ã‚Ã€~Â½Â¿Â¿Ã’â€“0Ã€ Æ’aÃ$Â©kÂ¿ÂºÃ‘â€ºÃ˜Ã¸â€“Ã¬gÃ…Â½Ã¹ÃƒÂºÃ¿IÂ®.ÂªÃq\\gÃ…0Ã”orÂ°ÃŒ0Â¶aÃâ€”Â§Å’ÂvÃ¢\\zÃ¼ËœÂ¿Zâ€¦Â¦Â­Ã§Â­Wâ€¡aâ„¢Ã´Â Ã±Ã»[N;Ã›Nâ€¦+Â¬9Ãº)Â¤~Ân~ Â¬Â«a,*ÂDÅ½Âªâ€¹Â±zÂ´Å½TEÂ°&ÃƒÂ"rzÃâ„¢â€°nâ€¡0Ã»XÃ‹Â®Â®UÂ¾Â©cÃœ1yÂºâ€¢Ã¯Å“ÃªÃ R Å¡w]Â.Â·1Ã…sÃ…6â€º1Â°â€šÂ¬Ã©Ã Å¡ÂÃŠ=`5Ã-Ãƒ9b!â€œÂÃ³Ã‘Ã·B(Ãâ€°tÃˆN{Ã¦,[Ã°	ÂÃ’(M=hT`JÂ¥Å“Â¬Â8Ã¨ad*Å¸ÂhÃ‡qJÃ°ÃšÃ¼Ã‚ÂµÂ»Ã©gÃ¿â€” Di#Â½Ã‘Å½(â€˜$Â»vÂ£Ã·â€”â‚¬|Ã˜&Â¢k^ Câ€¢Ã«jÃ¨{SeÃ†fÃ€\'oÃ¡ÃºÂ¼Ã±ÂÃÅ¸]0?N+Ã‘Ã‰\'Â¬Â£Âµâ€™ÃÃ±Ã Â¬ÂªÃ˜?S	Ã‡"Ã´0Ã«Ã8Ã™ÃÂ§LÃ°Ã–Ã™Â©^Â³gÃ„mÃŸÂâ€¹E(@|Â¯zÃ‹Ã”Â°0ÂµÃÂÂ·â„¢bËœÂAÂÃ½ATÃˆfÂMnÃ‡â€ºÃ‘ Â±Â .ÃªÃ¶â€ qÂ²Ã­0Ã—ffbÃŸ`6Â³cÃŠÃ»8Â´Ã¥LÃ·ÂÃ…Â­cxS\nÃªÃKÃŒÃ±Å¡Ã“â€¦:Â¥3Ã—dpEg|Ã¾9CÃ©Ã¿Ã©bFâ€¡Ã…Ã¯Â²#0Ã›Ã‰@Ãâ€˜Ã’Ãº>Â¼_MDo]PÂ£Â¹Å½FÂÃ‘yÃƒÂ¹Ã°Â·yÃ‰Ã­Â£Â¹â€™Å½Â¢cÃ‡â€œ	Ã·Â´##5U\'+Å¸ Â:Â¬Â®~ÂV/RrÂ¥Â¢7ZÂ¥ÂL[hÃ»OFCUÃ‰HSUÂ ÂUWYC]ZMSIÃ³Â¡Â£SECURESUPERSRCURÂ½'
	b = 'SUPERSRCURÂ½Â¿â€ÃƒÂ¹Ã‹Â¿ÂªÂ¶Æ’ÃŠÂ²Â¿BÂ¨â€Â¡.u_AËœÂ«ÃŸiwgÃuÂ¼Ã¬YÃ’ttâ€™~Ã­Å½QwÃ·Â¯Â»=7Pâ€¹â€œ&Ã™kÃ‡ÃšZÃ¬|-tLL7>Ã»Â»Ã–Ã Ã§%;Ã¦ÂºÃ¦Ã¯&+}ÃÂ¡5â€˜Ã¨â€ ÃÃ¾Ã­Ã‘ÂÂ¨gÃ…ÃšÃ§Ë†.â€¢Ã–â€"TÃ›RÃªÅ’gÃªiÃ–Ã’yâ€¦Â¯Å¾Å¾Ã”\\GÃ¦ÂªÂ¤UÃ…Ã·Â¯m6â€ºÃ¦ufÃ‹_â€˜Ã°~Ã’v^nâ€˜Ãƒ_Kvâ€œfdÂ¸Â³`Â§Â¬Ãµ$Ëœ|1Ã…EÃªâ€ ËœÂ£AÅ¸5Â¥7~Ãšâ€”hÃ Ãˆâ€¡^Å Ã†â€ |Ã™=VÂ¾Â²Ã£#v&cgÂ·Å“YE(Â â€¦â€“V(Ã \\wÃ²Ã¶z3Æ’dIÃ‹1â€¹~YÃŒd\nYÃeÂ Â¿Â²r\'Ã…SF)G\\Â bÂÂªÂ½t+OÃª\n)Ã´ÃxzHâ€¦0JÅ¸7ÃµÃ™-vÃ¦xÂ¥â„¢=Â¿ÂH6Ã˜\'qOÃ²Ã£6mâ€˜VÂ£]PÃ¯Ã¥ÃšÂ½ Ã¯F|Â´Ã²e%Â©Â¸.\'Â£Ã¼D9l:L?& Â¥HHfÃ›Ãš2Ãx DÃÃ‘,@ÃŠÃªÃ€â€œ/ÃÅ’Ã…*â€”Â®`K!Ã™Ã¡Ã²Â!Å¸y-ÃÂ°Ã°ÂÂ±NÃ®ÂµÃ¬Ã£ÂºdÃ¿Ã¦Â«"u=[?Ã»Ã¸P|rq4$ivÂÅ¡KÃ™Ã· ÃÃ¬yÂ /HÃ•ÃÃÅ¸;=	Bâ„¢ÃÃ™ÃŠÃ­NvÂ§<yeÂ©V"\'k}Ã©HÂ¸Â¥kÃ±Ãlâ„¢ÃŠÃ­Ã¯Ã§Â Ãˆ<ÃaÂºMaÃ¦Å¸Â²Ã˜IÂ¨Â¹Ã‡â‚¬8Ã˜Ã¬Ã¢Ã•ÃÃ–Ã®Ã“ÃÃ•Ã¬ÃˆÃœÂ²	PDÂkÅ¡Ã€({0pÅ Ã¨ÃÂ·Ã…QÃ¤Y(â€T DÃ±JÅ¡BÃŒ-9rÃ²Ã˜â€¦Ã‚#Å¡â€°Ã½rHÃ¶â€˜FRÅ AÃ¿â€°10Ã¢ÃdÃ¤ Â²â€¡Â¾ÃFÃ¶Â¥ÃÃ…Ã·Ã‰s@J-Â¶â€”}ÃÃ¨Ã’ÃƒÃ™ÃŠÃ†â€”ÃŸÅ¸Â¬Â¯Â Âº&9Ã®&VjSeÂ¬â€¡,)ÃÃ‰M_2Ã¯<Q)ÃµÃ·Ã¡Ã¡{C-[XYÃ°Å’$2â€¢Å½\\ZÃ‘Â¢Ã›dÃˆTSEÂ¦fREÂ£Â SIfSMK]R9Ã¶Â±Â¡ERSECURESUPEjSECÃÂ¾tÃŠÃ„Ã‚Â°Ã…Â»ÂªÂ¨Ã‰Ã…tÃ†Â½ÂµÂªÃ†â€sÂ»Ã‚Â¾Â©Â¢Â¿ Å c2bÂ¹;Ã¾Â»Â ?IÃ¬AtÂº)0RÂ®n.Y-mrÃ¡ÂrYâ„¢xnÃ¾4Ã£OÂ¬pÂª;SXÃƒ	Ã¬6Ã«â€°GÃ‘%Ã¤â€˜Â¸lqÂ`Ã“Â½Vâ€˜â€º5uSÃªp\\Â¼Mâ€™ Ã„aSÂ¨Ã«5â€˜Ã¥Ã—â€”=_{LÃ½Nâ‚¬Æ’Ã¥Ã“â€^Ã“bXâ€¦Ã«ËœÃÅ“Â°Â®Å Ã¤Å¾â€šÃ«lÂ¦DÃŸÅ½n=Ã±Â©Å¸<ÃÂ©MbÃ@Â ÃœÃ«5DÂ'
	for i in range(len(b)):
		try:
			print(ord(b[i]), ord(a[i]), chr(ord(b[i]) - ord(a[i])))
		except:
			continue

	a = '     ' # -> super entails 115 - 32 = 83, enc - 83 = dec
	b = 'super' # -> 115 - 83 = 32, enc - key = dec
	# dec + key = enc


def solve():
	f = open('./login.xlsx.enc', 'rb').read()
	f = ''.join([chr(i) for i in f])
	KEY = 'SUPERSECURE'
	ret_values = []
	# print(''.join([chr(i) for i in f]))
	for i in range(len(f)):
		print("i is: ", i)
		# enc - key = dec
		val = f[i]
		temp = (ord(val) - ord(KEY[i % len(KEY)]) )% 256
		ret_values.append(temp)
		
	print(ret_values)

	ret_bytes = b''
	f2 = open('temp.xlsx', 'wb')
	for i in ret_values:
		f2.write(bytes([i]))

	# Flag: HTB{M4lW4R3_4n4LY5I5_IN73r357iN9_57uFF}

		
def main():

	# change()
	solve()


if __name__ == '__main__':
	main()